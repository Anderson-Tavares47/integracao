name: Test Secret Access

on:
  push:
    branches:
      - main  # O workflow ser√° executado ao fazer push para a branch main

jobs:
  test-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '16'

      - name: Fetch Secret from Local Server
        env:
          # Defina a URL gerada pelo ngrok para expor o servidor local
          API_URL: https://f810-2804-1330-13a-d200-5daf-7f00-4140-c68b.ngrok-free.app/receive-secret
          API_KEY: minha_chave_de_api_segura
        run: |
          curl -X GET "$API_URL" -H "x-api-key: $API_KEY"
